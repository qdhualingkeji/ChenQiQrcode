function getUrlPara(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),i=decodeURIComponent(window.location.search).substr(1).match(t);return null!=i?unescape(i[2]):0}function StatisticsData(e,t){$.ajax({async:!0,type:"get",url:"/Api/ClickLog/click",data:{fir:e,sec:t},dataType:"jsonp",jsonp:"callback",success:function(){}})}function checkLogin(e,t,i,o,n){o&&CopyCase(e,t,i,o,n)}function CopyCaseHuoma(e){$.ajax({type:"GET",url:"/apis/QrcodeCase/copy",data:{case_id:e,from_id:4},dataType:"json",success:function(e){$("[create-wp-qrcode]").button("reset"),1==e.status?window.location.href=e.data.edit_link:alert(e.info,"danger")}})}function checkLoginHuoma(e){return""==account?($("#modal-intro").modal("hide"),seajs.use("//"+STATIC_SERVICE+"/js/login_plugin.js?v=20190610",function(t){t.login_plugin("login","",function(){$("#iframe").hide(),$("#login_join",window.parent.document).hide(),$("#close_login",window.parent.document).hide(),$("body",window.parent.document).removeClass("modal-active"),$("#login",window.parent.document).hide(),$("#myqr_out",window.parent.document).show(),CopyCaseHuoma(e)},1,"")}),!1):void CopyCaseHuoma(e)}function CopyCase(e,t,i,o,n){if(7!=o&&8!=o||1==n){var a=window.open("about:blank");a&&(8!=o&&7!=o&&a.document.write("创建中..."),a.document.title="创建中...")}$.ajax({type:"GET",url:"/apis/QrcodeCase/copyV2",data:{btn_id:e,preview:t,scene_id:i,create_from:26},dataType:"json",success:function(n){1==n.status?a?a.location.href=n.data.edit_link:window.location.href=n.data.edit_link:2==n.status?needLogin(e,t,i,n.info,o):alert(n.info,"danger")}})}function needLogin(e,t,i,o,n){return seajs.use("//"+STATIC_SERVICE+"/js/login_plugin.js?v=20190610",function(o){o.login_plugin("login","",function(){$("#iframe").hide(),$("#login_join",window.parent.document).hide(),$("#close_login",window.parent.document).hide(),$("body",window.parent.document).removeClass("modal-active"),$("#login",window.parent.document).hide(),$("#myqr_out",window.parent.document).show(),CopyCase(e,t,i,n,1)},1,"")}),!1}function setCookie(e,t){var i=30,o=new Date;o.setTime(o.getTime()+24*i*60*60*1e3),document.cookie=e+"="+escape(t)+";expires="+o.toGMTString()}function getCookie(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return null!=t?t[2]:""}function delCookie(e){var t=new Date;t.setTime(t.getTime()-1);var i=getCookie(e);null!=i&&(document.cookie=e+"="+i+";expires="+t.toGMTString())}function resetPreview(){$(".cli_head_inner>ul>li .menu-hd").css("z-index","999"),$("body").css("overflow","auto"),$(".preview_doc_show").addClass("none"),$(".preview_doc_show img").removeAttr("src");var e=$(".preview_doc_show .preview_doc_show_use");e.removeAttr("data-id"),e.removeAttr("scene_id"),e.removeAttr("is_preview"),e.removeAttr("code-click-data"),e.removeAttr("data-type")}function StatisticsDataWithComment(e,t,i){$.ajax({async:!0,type:"get",url:"/Api/ClickLog/click",data:{fir:e,sec:t,comment:i},dataType:"jsonp",jsonp:"callback"})}function isAbTestScene(){return!1}/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)?$(document).on("click",".create-detail-used-btn",function(){$("#modal-alert-mobile").modal("show")}):$(document).on("click",".create-detail-used-btn",function(){var e=$(this),t=$("#tpl-id").val(),i=e.attr("is_preview"),o=e.attr("scene_id"),n=e.attr("code-click-data");return t?(StatisticsData(n,t),checkLogin(t,i,o),$(this).button("loading"),void 0):("none"===$("#no-choose").css("display")&&$("#no-choose").fadeIn("fast").delay(2e3).fadeOut(),void $("html, body").animate({scrollTop:0},200))}),$(function(){var e=getUrlPara("comment_id");e&&$("#comment-"+e).length>0&&$("html, body").animate({scrollTop:$("#comment-"+e).offset().top-62},400)}),$(document).on("click","[tab-tpl-item]",function(){var e=$("#tpl-id");if($(this).find(".JoinStep-common-guild-boxInner").hasClass("active"))e.val(""),$(this).find(".JoinStep-common-guild-boxInner").removeClass("active"),$(".title-img-box :not([titie-img-scene])").hide(),$("[titie-img-scene]").show();else{$("#no-choose").fadeOut();var t=$(this).attr("data-id");$("[img-id="+t+"]").show().siblings().hide(),e.val(t),$(this).find(".JoinStep-common-guild-boxInner").addClass("active").parent().siblings().find(".JoinStep-common-guild-boxInner").removeClass("active")}}),$(document).on("click","[tab_href]",function(){var e=$(this),t=e.attr("code-click-data").split(","),i=e.attr("title");StatisticsDataWithComment(t[0],t[1],sceneTitle+"-"+i)}),$(document).on("click","[create-wp-qrcode]",function(){var e=$(this).attr("is_nencao"),t=$(this).attr("data_id"),i=$(this).attr("scene_id");$(this).button("loading"),0==e?checkLoginHuoma(t):CopyCase(t,0,i)}),$(function(){if($(".JoinStep-common-guild-box").length>1&&$(".JoinStep-common-guild-box").first().click(),isAbTestScene()){var e=$("#leftBox").find("[go-preview]");e.length>0&&e[0].click(),$(".preview_doc_show_use").text("立即开始编辑")}}),$(document).on("click","[go-preview]",function(){$(".cli_head_inner>ul>li .menu-hd").css("z-index","auto"),$("body").css("overflow","hidden");var e=$(this).attr("data-id"),t=$(this).attr("scene_id"),i=$(this).attr("is_preview"),o=$(this).attr("code-click-data"),n=$(this).attr("data-type"),a=$(this).attr("data-long");$(".preview_doc_show_loading").show(),StatisticsDataWithComment(123,e,$.trim($(this).text()));var s=new Image;s.onload=function(){$(".preview_doc_show_loading").hide(),900==this.width||1800==this.width?$(".preview_doc_show_main").css("width","703px").css("margin-left","-187px"):1200==this.width||2400==this.width?$(".preview_doc_show_main").css("width","1200px").css("margin-left","-487px"):$(".preview_doc_show_main").css("width","375px").css("margin-left","-187px"),$(".preview_doc_show img").attr("src",a)},s.src=a;var c=$(".preview_doc_show .preview_doc_show_use");c.attr("data-id",e),c.attr("scene_id",t),c.attr("is_preview",i),c.attr("code-click-data",o),c.attr("data-type",n),$(".preview_doc_show").removeClass("none")}),$(document).on("click",".preview_doc_show",function(){isAbTestScene()||resetPreview()}),$(document).on("click",".preview_doc_show_close",function(){if(isAbTestScene()){var e=sessionStorage.getItem("is_scene_close_ab_test");e||(window.location.pathname.indexOf(429)>-1?StatisticsData(121,211):window.location.pathname.indexOf(1031)>-1?StatisticsData(121,213):window.location.pathname.indexOf(442)>-1&&StatisticsData(121,215)),sessionStorage.setItem("is_scene_close_ab_test",1),sessionStorage.setItem("is_scene_ab_edit_test",1),resetPreview()}}),$(document).on("click","[create-tpl-item], [create-tpl-item-top]",function(e){e.stopPropagation();var t=$(this).attr("data-id"),i=$(this).attr("scene_id"),o=$(this).attr("is_preview"),n=$(this).attr("code-click-data"),a=$(this).attr("data-type");if(isAbTestScene()){var s=sessionStorage.getItem("is_scene_ab_edit_test");s||(window.location.pathname.indexOf(429)>-1?StatisticsData(121,212):window.location.pathname.indexOf(1031)>-1?StatisticsData(121,214):window.location.pathname.indexOf(442)>-1&&StatisticsData(121,216)),sessionStorage.setItem("is_scene_close_ab_test",1),sessionStorage.setItem("is_scene_ab_edit_test",1)}var c;if(c=""==account?0:1,!t)return resetPreview(),void alert("无案例ID");StatisticsData(n,t);var d=new CreateQuickCodeById({scene_id:i,data_Id:t,type:a,is_login:c,is_preview:o,createSuccess:function(){resetPreview()},createFail:function(){resetPreview()}});d.gotoCreate()});